{
    "sourceFile": "docs/architecture/design-principles.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1762032999870,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1762032999870,
            "name": "Commit-0",
            "content": "# clap-noun-verb: Design Principles\n\n## Core Principle: CLI as Interface Layer\n\nThe CLI is **only an interface layer** that validates arguments and delegates to reusable business logic. The business logic layer is completely independent and can be used by CLI, API, web apps, or any other interface.\n\n## Key Design Principles\n\n### 1. CLI Code ONLY Validates Arguments\n\nThe CLI layer contains **NO business logic**. It only:\n\n- Validates argument types and formats\n- Validates option combinations\n- Extracts validated arguments\n- Delegates to business logic functions\n\n**Enforcement**: The type system prevents business logic in CLI code.\n\n### 2. Business Logic is Reusable\n\nBusiness logic functions are:\n\n- Pure functions (no side effects unless intentional)\n- Independent of CLI implementation\n- Callable from any interface (CLI, API, Web, etc.)\n- Testable in isolation\n\n### 3. Clear Separation of Concerns\n\n```\nCLI Layer:     Argument validation → Delegation\nLogic Layer:   Pure business functions\nRuntime Layer: Execution infrastructure\n```\n\n### 4. Type System Enforcement\n\nThe type system enforces the pattern:\n\n- `VerbCommand::run()` is **removed** (prevented direct execution)\n- Only `validate()` and `delegate()` methods allowed\n- Business logic functions have separate types\n\n## Architecture Layers\n\n### Layer 1: CLI Layer (`src/cli/`)\n\n**Responsibility**: Argument/option validation and routing only\n\n- `CliBuilder` - Builds CLI structure\n- `Router` - Routes commands\n- `ArgValidator` - Validates arguments and options\n- **NO business logic allowed**\n\n### Layer 2: Business Logic Layer (`src/logic/`)\n\n**Responsibility**: Reusable business functions\n\n- `CommandHandlers` - Handler functions for commands\n- `CoreFunctions` - Pure business logic functions\n- **Independent of CLI** - can be used by any interface\n\n### Layer 3: Runtime Layer (`src/runtime/`)\n\n**Responsibility**: Execution infrastructure\n\n- `Executor` - Executes business logic\n- `Interceptor` - Cross-cutting concerns (logging, tracing, etc.)\n\n## Example: Before vs After\n\n### Before (v1): Business logic in CLI\n\n```rust\nverb!(\"status\", \"Show status\", |args: &VerbArgs| {\n    // ❌ Business logic in CLI code!\n    println!(\"All services are running\");\n    Ok(())\n})\n```\n\n### After (v3.0.0): Business logic separated\n\n```rust\nuse clap_noun_verb::cli::builder::CliBuilder;\nuse clap_noun_verb::logic::{HandlerInput, HandlerOutput, OutputData};\nuse clap_noun_verb::Result;\n\n// Business logic (reusable)\nfn show_status(_input: HandlerInput) -> Result<HandlerOutput> {\n    // Pure function, reusable by CLI, API, Web, etc.\n    Ok(HandlerOutput {\n        data: OutputData::Text(\"All services running\".to_string()),\n        message: None,\n    })\n}\n\n// CLI (validation + delegation only)\nfn main() -> Result<()> {\n    let cli = CliBuilder::new(\"myapp\")\n        .about(\"My application\")\n        .noun(\"services\", \"Manage services\")\n        .verb(\"services\", \"status\", \"Show status\", show_status);\n    \n    cli.run()\n}\n```\n\n## Benefits\n\n1. **Reusability**: Business logic can be used by CLI, API, Web, etc.\n2. **Testability**: Business logic functions can be tested independently\n3. **Maintainability**: Clear separation makes code easier to understand\n4. **Enforcement**: Type system prevents mixing concerns\n5. **Scalability**: Easy to add new interfaces without duplicating logic\n\n## Migration Path\n\nUsers will:\n\n1. Extract business logic from verb closures to separate functions\n2. Keep CLI code minimal - only validation and delegation\n3. Reuse business logic functions across interfaces\n\n"
        }
    ]
}